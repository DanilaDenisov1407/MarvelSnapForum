<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marvel Snap Forum Wiki</title>
    <style>
        /* Your existing styles */
    </style>
</head>
<body>

    <h1>Marvel Snap Forum Wiki</h1>

    <!-- Раздел: Мнения игроков о карте -->
    <button class="accordion">Мнения игроков о карте</button>
    <div class="panel">
        <ul></ul>
    </div>

    <!-- Раздел: Превью Карт -->
    <button class="accordion">Превью Карт</button>
    <div class="panel">
        <ul></ul>
    </div>

    <!-- Раздел: Остальное -->
    <button class="accordion">Остальное</button>
    <div class="panel">
        <ul></ul>
    </div>

    <script>
        const accordions = document.querySelectorAll('.accordion');
        const panels = document.querySelectorAll('.panel');

        accordions.forEach((acc, index) => {
            acc.addEventListener('click', function() {
                this.classList.toggle('active');
                const panel = panels[index];
                if (panel.style.maxHeight) {
                    panel.style.maxHeight = null;
                } else {
                    panel.style.maxHeight = panel.scrollHeight + 'px';
                }
            });
        });

        // Google Sheets URL (Replace with your published sheet link)
        const sheetUrl = "https://script.google.com/macros/s/AKfycbz69n-cSYZOaI8zSlPk1Yq5PG84vhvyIvCO4d6SNNOX3PeTp4-zL7sdAx9niIavnq_rKw/exec";

        // Fetch and filter links
        fetch(sheetUrl)
            .then(response => response.text())
            .then(data => {
                const rows = data.split("\n").slice(1); // skip header
                rows.forEach(row => {
                    const [url, title, date, category] = row.split(",");

                    let match;
                    if (category.includes("opinion")) {
                        match = 1; // First panel (Мнения игроков о карте)
                    } else if (category.includes("preview")) {
                        match = 2; // Second panel (Превью Карт)
                    } else {
                        match = 3; // Third panel (Остальное)
                    }

                    const ul = document.querySelector(`.panel:nth-of-type(${match}) ul`);
                    const li = document.createElement("li");
                    const a = document.createElement("a");
                    a.href = url;
                    a.textContent = `${title} - ${date}`;
                    a.target = "_blank";
                    li.appendChild(a);
                    ul.appendChild(li);
                });
            })
            .catch(error => console.error("Error fetching data:", error));
    </script>

</body>
</html>
