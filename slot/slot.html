<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>üé∞ –°–ª–æ—Ç –ú–∞—à–∏–Ω–∞</title>
  <style>
    body {
      background: #111;
      color: #fff;
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 30px;
    }
    h1 {
      margin-bottom: 20px;
    }
    .slot {
      display: flex;
      justify-content: center;
      margin: 20px 0;
    }
    .reel {
      width: 120px;
      height: 120px;
      overflow: hidden;
      border: 2px solid #fff;
      border-radius: 10px;
      margin: 0 10px;
      position: relative;
      background: #222;
    }
    .reel .reel-strip {
      position: absolute;
      width: 100%;
      top: 0;
      left: 0;
    }
    .reel img {
      width: 100%;
      height: 120px;
      display: block;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      margin-top: 20px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
    }
    #result {
      margin-top: 20px;
      font-size: 20px;
    }
  </style>
</head>
<body>
  <h1>üé∞ –°–ª–æ—Ç –ú–∞—à–∏–Ω–∞</h1>
  <div class="slot">
    <div class="reel"><div class="reel-strip"></div></div>
    <div class="reel"><div class="reel-strip"></div></div>
    <div class="reel"><div class="reel-strip"></div></div>
  </div>
  <button onclick="spin()">–ö—Ä—É—Ç–∏—Ç—å!</button>
  <div id="result"></div>

  <script>
    let cards = [];

    // –ó–∞–≥—Ä—É–∂–∞–µ–º JSON —Å –∫–∞—Ä—Ç–∞–º–∏
    async function loadCards() {
      const response = await fetch("slot/Cards.json");
      cards = await response.json();
    }

    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–π –∫–∞—Ä—Ç—ã
    function getRandomCard() {
      const idx = Math.floor(Math.random() * cards.length);
      return cards[idx];
    }

    async function spin() {
      const reels = document.querySelectorAll(".reel-strip");
      const results = [];

      reels.forEach((reel, index) => {
        reel.innerHTML = ""; // –æ—á–∏—â–∞–µ–º –ª–µ–Ω—Ç—É

        // –≤—ã–±–∏—Ä–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—É—é –∫–∞—Ä—Ç—É
        const finalCard = getRandomCard();
        results.push(finalCard);

        // —Å–æ–∑–¥–∞—ë–º –ª–µ–Ω—Ç—É: —Å–ª—É—á–∞–π–Ω—ã–µ –∫–∞—Ä—Ç—ã + —Ñ–∏–Ω–∞–ª—å–Ω–∞—è
        for (let i = 0; i < 5; i++) {
          const card = getRandomCard();
          const img = document.createElement("img");
          img.src = card.image;
          reel.appendChild(img);
        }

        // —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞ –≤–Ω–∏–∑—É
        const finalImg = document.createElement("img");
        finalImg.src = finalCard.image;
        reel.appendChild(finalImg);

        // —Å—á–∏—Ç–∞–µ–º –≤—ã—Å–æ—Ç—É
        const totalHeight = reel.scrollHeight - 120;
        reel.style.transition = "none";
        reel.style.top = `-${totalHeight}px`; // —Å—Ç–∞–≤–∏–º –ª–µ–Ω—Ç—É —Å–≤–µ—Ä—Ö—É

        // –∞–Ω–∏–º–∞—Ü–∏—è –≤–Ω–∏–∑
        setTimeout(() => {
          reel.style.transition = `top ${1 + index * 0.5}s ease-out`;
          reel.style.top = "0px";
        }, 50);
      });

      // –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–∏–≥—Ä—ã—à–∞ –ø–æ—Å–ª–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
      setTimeout(() => {
        const win = results.every(card => card.name === results[0].name);
        document.getElementById("result").innerHTML = win
          ? "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º, —Ç—ã –≤—ã–∏–≥—Ä–∞–ª!"
          : "üò• –ü–æ–ø—Ä–æ–±—É–π –µ—â—ë!";
      }, 2500);
    }

    loadCards();
  </script>
</body>
</html>
